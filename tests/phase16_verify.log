
> dagifier@1.0.0 test
> vitest run tests/core_features.test.ts tests/cri.test.ts tests/nav.test.ts


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90m/Users/anton/Code/Dagifier[39m

 [31mâ¯[39m tests/cri.test.ts [2m([22m[2m4 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 1637[2mms[22m[39m
     [32mâœ“[39m should init valid config[32m 3[2mms[22m[39m
[31m     [31mÃ—[31m apply should create backup[39m[33m 683[2mms[22m[39m
     [33m[2mâœ“[22m[39m rollback should revert state [33m 519[2mms[22m[39m
[31m     [31mÃ—[31m prune should remove excess backups[39m[33m 431[2mms[22m[39m
 [31mâ¯[39m tests/nav.test.ts [2m([22m[2m3 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 2189[2mms[22m[39m
[31m     [31mÃ—[31m list should return JSON structure[39m[33m 757[2mms[22m[39m
[31m     [31mÃ—[31m list --project should filter correctly[39m[33m 521[2mms[22m[39m
     [33m[2mâœ“[22m[39m search should respect scopes (integration-ish) [33m 906[2mms[22m[39m
 [32mâœ“[39m tests/core_features.test.ts [2m([22m[2m9 tests[22m[2m)[22m[33m 7075[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: Markdown Output [33m 1211[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: Section Filtering [33m 713[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: Author Filtering [33m 1277[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: Edge Case - Empty Input [33m 594[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: Edge Case - Malformed HTML [33m 613[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: Stats [33m 659[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: Highlighting [33m 757[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: ASCII Only [33m 647[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: Sorting [33m 604[2mms[22m[39m

[31mâ¯â¯â¯â¯â¯â¯â¯[39m[1m[41m Failed Tests 4 [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m

[41m[1m FAIL [22m[49m tests/cri.test.ts[2m > [22mCRI Unit Logic (via CLI)[2m > [22mapply should create backup
[31m[1mAssertionError[22m: expected '{"theme":"dark","version":2}\n' to contain '"theme": "dark"'[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- "theme":[7m [27m"dark"[39m
[31m+ [7m{[27m"theme":"dark"[7m,"version":2}[27m[39m
[31m+[39m

[36m [2mâ¯[22m tests/cri.test.ts:[2m34:25[22m[39m
    [90m 32| [39m        [90m// Check content updated[39m
    [90m 33| [39m        [35mconst[39m updated [33m=[39m fs[33m.[39m[34mreadFileSync[39m([33mCONFIG_FILE[39m[33m,[39m [32m'utf-8'[39m)[33m;[39m
    [90m 34| [39m        [34mexpect[39m(updated)[33m.[39m[34mtoContain[39m([32m'"theme": "dark"'[39m)[33m;[39m
    [90m   | [39m                        [31m^[39m
    [90m 35| [39m
    [90m 36| [39m        [90m// Check backup exists[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/4]â¯[22m[39m

[41m[1m FAIL [22m[49m tests/cri.test.ts[2m > [22mCRI Unit Logic (via CLI)[2m > [22mprune should remove excess backups
[31m[1mAssertionError[22m: expected 10 to be 3 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 3[39m
[31m+ 10[39m

[36m [2mâ¯[22m tests/cri.test.ts:[2m61:32[22m[39m
    [90m 59| [39m        const backups = files.filter(f => f.startsWith('config.json.20â€¦
    [90m 60| [39m        // Pruning logic might differ (e.g. strict dates), but count sâ€¦
    [90m 61| [39m        [34mexpect[39m(backups[33m.[39mlength)[33m.[39m[34mtoBe[39m([34m3[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m 62| [39m    })[33m;[39m
    [90m 63| [39m})[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/4]â¯[22m[39m

[41m[1m FAIL [22m[49m tests/nav.test.ts[2m > [22mNav Unit Logic (via CLI)[2m > [22mlist should return JSON structure
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2mâ¯[22m tests/nav.test.ts:[2m33:29[22m[39m
    [90m 31| [39m        [35mconst[39m data [33m=[39m [33mJSON[39m[33m.[39m[34mparse[39m(output)[33m;[39m
    [90m 32| [39m        [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(data))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m 33| [39m        [34mexpect[39m(data[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m 34| [39m        const manual = data.find((d: any) => d.path.includes('manual.mâ€¦
    [90m 35| [39m        [34mexpect[39m(manual)[33m.[39m[34mtoBeDefined[39m()[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/4]â¯[22m[39m

[41m[1m FAIL [22m[49m tests/nav.test.ts[2m > [22mNav Unit Logic (via CLI)[2m > [22mlist --project should filter correctly
[31m[1mAssertionError[22m: expected +0 to be 1 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 1[39m
[31m+ 0[39m

[36m [2mâ¯[22m tests/nav.test.ts:[2m44:29[22m[39m
    [90m 42| [39m        const output = execSync(`${TSX} list -C ${TEST_DIR} --project â€¦
    [90m 43| [39m        [35mconst[39m data [33m=[39m [33mJSON[39m[33m.[39m[34mparse[39m(output)[33m;[39m
    [90m 44| [39m        [34mexpect[39m(data[33m.[39mlength)[33m.[39m[34mtoBe[39m([34m1[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m 45| [39m        [34mexpect[39m(data[[34m0[39m][33m.[39mpath)[33m.[39m[34mtoContain[39m([32m'projects/P1/plan.md'[39m)[33m;[39m
    [90m 46| [39m    })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[4/4]â¯[22m[39m


[2m Test Files [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (3)[39m
[2m      Tests [22m [1m[31m4 failed[39m[22m[2m | [22m[1m[32m12 passed[39m[22m[90m (16)[39m
[2m   Start at [22m 13:08:53
[2m   Duration [22m 7.25s[2m (transform 181ms, setup 0ms, import 201ms, tests 10.90s, environment 0ms)[22m

