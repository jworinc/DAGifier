
> dagifier@1.0.0 test
> vitest run tests/core_features.test.ts tests/cri.test.ts


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90m/Users/anton/Code/Dagifier[39m

 [31mâ¯[39m tests/cri.test.ts [2m([22m[2m4 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 1582[2mms[22m[39m
     [32mâœ“[39m should init valid config[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m apply should create backup[39m[33m 826[2mms[22m[39m
     [33m[2mâœ“[22m[39m rollback should revert state [33m 375[2mms[22m[39m
[31m     [31mÃ—[31m prune should remove excess backups[39m[33m 379[2mms[22m[39m
 [32mâœ“[39m tests/core_features.test.ts [2m([22m[2m7 tests[22m[2m)[22m[33m 6297[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: Markdown Output [33m 1185[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: Section Filtering [33m 663[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: Author Filtering [33m 1722[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: Stats [33m 672[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: Highlighting [33m 654[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: ASCII Only [33m 682[2mms[22m[39m
   [33m[2mâœ“[22m[39m Core Feature: Sorting [33m 718[2mms[22m[39m

[31mâ¯â¯â¯â¯â¯â¯â¯[39m[1m[41m Failed Tests 2 [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m

[41m[1m FAIL [22m[49m tests/cri.test.ts[2m > [22mCRI Unit Logic (via CLI)[2m > [22mapply should create backup
[31m[1mAssertionError[22m: expected '{"theme":"dark","version":2}\n' to contain '"theme": "dark"'[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- "theme":[7m [27m"dark"[39m
[31m+ [7m{[27m"theme":"dark"[7m,"version":2}[27m[39m
[31m+[39m

[36m [2mâ¯[22m tests/cri.test.ts:[2m34:25[22m[39m
    [90m 32| [39m        [90m// Check content updated[39m
    [90m 33| [39m        [35mconst[39m updated [33m=[39m fs[33m.[39m[34mreadFileSync[39m([33mCONFIG_FILE[39m[33m,[39m [32m'utf-8'[39m)[33m;[39m
    [90m 34| [39m        [34mexpect[39m(updated)[33m.[39m[34mtoContain[39m([32m'"theme": "dark"'[39m)[33m;[39m
    [90m   | [39m                        [31m^[39m
    [90m 35| [39m
    [90m 36| [39m        [90m// Check backup exists[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/2]â¯[22m[39m

[41m[1m FAIL [22m[49m tests/cri.test.ts[2m > [22mCRI Unit Logic (via CLI)[2m > [22mprune should remove excess backups
[31m[1mAssertionError[22m: expected 10 to be 3 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 3[39m
[31m+ 10[39m

[36m [2mâ¯[22m tests/cri.test.ts:[2m61:32[22m[39m
    [90m 59| [39m        const backups = files.filter(f => f.startsWith('config.json.20â€¦
    [90m 60| [39m        // Pruning logic might differ (e.g. strict dates), but count sâ€¦
    [90m 61| [39m        [34mexpect[39m(backups[33m.[39mlength)[33m.[39m[34mtoBe[39m([34m3[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m 62| [39m    })[33m;[39m
    [90m 63| [39m})[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/2]â¯[22m[39m


[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (2)[39m
[2m      Tests [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m9 passed[39m[22m[90m (11)[39m
[2m   Start at [22m 13:06:27
[2m   Duration [22m 6.56s[2m (transform 304ms, setup 0ms, import 316ms, tests 7.88s, environment 0ms)[22m

